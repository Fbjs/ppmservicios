<div
  class="z-50 dark text-muted text-sm bg-black dark:border-b dark:border-slate-800 dark:text-slate-400 hidden md:flex gap-1 overflow-hidden px-3 py-2 relative text-ellipsis whitespace-nowrap justify-between"
>
  <div class="flex gap-2">
    <span
      class="dark:bg-slate-700 bg-white/40 dark:text-slate-300 font-semibold px-1 py-0.5 text-xs mr-0.5 rtl:mr-0 rtl:ml-0.5 inline-block"
      >NUEVO</span
    >
    <a id="dynamic-link" href="/services/mantencion-preventiva" class="text-muted hover:underline dark:text-slate-400 font-medium"
      >¡Conoce nuestros planes de mantención preventiva para maquinaria pesada!</a
    >
  </div>

  <a href="https://wa.me/56963238857?text=Hola,%20me%20gustaría%20recibir%20más%20información" target="_blank" class="flex items-center justify-center font-semibold text-white space-x-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-whatsapp">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9" />
      <path d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1" />
    </svg>
    <span>Chatea con un Asesor</span>
  </a>
</div>

<script>
  const news = [
    {
      text: "¡Conoce nuestros planes de mantención preventiva para maquinaria pesada!",
      link: "/services/mantencion-preventiva",
    },
    {
      text: "¿Necesitas repuestos especializados? Descubre nuestras soluciones.",
      link: "/repuestos",
    },
    {
      text: "Servicio spot en terreno: ¡Atención rápida y eficiente donde lo necesites!",
      link: "/services/servicio-spot",
    },
    {
      text: "Automatización de equipos: Lleva tu maquinaria al siguiente nivel.",
      link: "/services/automatizacion",
    }
  ];

  let currentIndex = 0;
  const dynamicLink = document.getElementById('dynamic-link');
  let intervalId;

  function rotateNews() {
    if (dynamicLink) {
      currentIndex = (currentIndex + 1) % news.length;
      dynamicLink.textContent = news[currentIndex].text;
      dynamicLink.href = news[currentIndex].link;
    }
  }

  function startNewsRotation() {
    intervalId = setInterval(rotateNews, 5000);
  }

  function stopNewsRotation() {
    clearInterval(intervalId);
  }

  window.addEventListener('load', startNewsRotation);
  window.addEventListener('beforeunload', stopNewsRotation);

  const observer = new MutationObserver(() => {
    if (!document.getElementById('dynamic-link')) {
      stopNewsRotation();
      observer.disconnect();
    }
  });

  observer.observe(document.body, { childList: true, subtree: true });
</script>
